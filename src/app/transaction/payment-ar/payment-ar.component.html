<div class="center">
    <table style="width: 100%;background-color: white;">
        <tr>
            <td class="PageHeader">
                &nbsp;&nbsp;AR&nbsp;PAYMENT&nbsp;RECEIPT&nbsp;&nbsp;
            </td>
        </tr>
    </table>

    <div class="center" style="width: 100%;">
        <div class="form-bg">
            <div class="center" style="width: 100%;">
                <form [formGroup]="paymentArForm" (ngSubmit)="paymentAr(paymentArForm.value)">

                    <table class="center">
                        <tr>

                        <td>
                            <input  hidden  style="width:30px ;"   type="text" formControlName="orgId"
                            class="form-control" [(ngModel)]="orgId" >
                        </td>

                        <td>
                            <input hidden  style="width:30px ;"   type="text" formControlName="divisionId"
                            class="form-control" [(ngModel)]="divisionId" >
                        </td>
                     
                        <td>
                            <input hidden style="width:30px ;"  type="text" formControlName="locationId"  [(ngModel)]="locationId" class="form-control"  placeholder="Location Name">
                        </td>

                        <!-- <td style="width: 15%" class="LabelFontStyle">Emp&nbsp;Id:&nbsp;</td> -->

                        <td >
                            <input hidden style="width:30px ;"  type="text"  formControlName="emplId"
                            class="form-control" [(ngModel)]="emplId" placeholder="">

                        </td>

                        <td>
                            <input  hidden style="width:30px ;" type="text"  formControlName="customerId"  id="customerId" [(ngModel)]="customerId" class="form-control" >
                        </td>
                        <!-- <td>
                            <input  disabled style="width:30px ;" type="text"  formControlName="status"  id="status" [(ngModel)]="status" class="form-control" >
                        </td> -->



                                            
                      </tr>
                    </table>

                    <!-- 
                    <tr>
                    <td> -->

                    <fieldset class="RFS">
                        <!-- <legend id="FormsPH_LGAadhaar" class="RFSL" style="font-size: 10px;color: black;">Order Details</legend> -->
                        <legend id="FormsPH_LGAadhaar" class="RFSL" style="font-size: 10px;color: black;">Location | Customer </legend>
                    <table class="center">
                          
                       <tr>

                        <td style="width: 15%" class="LabelFontStyle">Division&nbsp;:&nbsp;</td>
                        <td   style="border: none;color: black;">
                            <input type="text" disabled formControlName="loginArray"
                                class="form-control" [(ngModel)]="loginArray" style="background-color: lightgreen;">
                        </td>


                        <td style="width: 15%" class="LabelFontStyle">Operating&nbsp;Unit:&nbsp;</td>

                        <div *ngIf="displayButton ,then thenshowOu1; else thenshowOu2")></div>
                        <ng-template #thenshowOu1>

                        <td>  
                            <select disabled  formControlName="orgId" id="orgId" [(ngModel)]="orgId"  class="form-control" (ngModelChange)='onOuIdSelected($event)' style="background-color: lightgreen;" >
                            <option disabled>--Select--</option>
                            <option *ngFor="let sc of  OUIdList" [ngValue]="sc.ouId">
                            {{sc.ouId}}-{{sc.ouName}}
                            </option>
                            </select>
                        </td>

                        </ng-template>

                        <ng-template #thenshowOu2>

                            <td>  
                                <select disabled  formControlName="orgId" id="orgId" [(ngModel)]="orgId"  class="form-control"  style="background-color: lightgreen;" >
                                <option disabled>--Select--</option>
                                <option *ngFor="let sc of  OUIdList" [ngValue]="sc.ouId">
                                {{sc.ouId}}-{{sc.ouName}}
                                </option>
                                </select>
                            </td>
    
                            </ng-template>



                        <td style="width: 15%" class="LabelFontStyle">Location&nbsp;:&nbsp;</td>

                        <td>
                        <select disabled formControlName="locId" id="locId" [(ngModel)]="locId"  class="form-control" style="background-color: lightgreen;"   >
                            <!-- (ngModelChange)='onLocationSelected1($event,i)' -->
                            <option disabled>--Select--</option>
                            <option *ngFor="let sc of locIdList"  [ngValue]="sc.locId">
                            {{sc.locId}}-{{sc.locCode}}-{{sc.locName}}
                            </option>
                        </select>
                        </td>

                        <td style="width: 15%" class="LabelFontStyle">Dept&nbsp;:</td>

                        <td>  
                            <select  disabled formControlName="deptId" id="deptId" [(ngModel)]="deptId" class="form-control" style="background-color: lightgreen;">
                                <option disabled>--Select--</option>
                                <option *ngFor="let sc of  DepartmentList" [ngValue]="sc.cmnTypeId">
                                    {{sc.cmnTypeId}}-{{sc.code}}
                                </option>
                            </select>
                        </td>



                        
                      

                     <!-- <td style="width: 15%" class="LabelFontStyle">Insurance&nbsp;:&nbsp;</td>
                     
                     <td>
                         <input  type="checkbox"  name="insuranceFlag" formControlName="insuranceFlag"  [(ngModel)]="insuranceFlag"  (change)="insuranceFlag1($event)">
                     </td> -->
                       </tr>

                       <tr>

                        <td style="width: 15%" class="LabelFontStyle">Vehicle&nbsp;No:&nbsp;</td>
                        <td>
                         <input type="text"
                            formControlName="attribute1"
                            [(ngModel)]="attribute1"
                            (change)="serchByRegNo(attribute1)"
                            (keyup)="getUserIdsFirstWay($event)"
                            id="userIdFirstWay"
                            list="dynmicUserIds"
                            class="form-control" />

                            <datalist id="dynmicUserIds">
                                <option
                                    *ngFor="let item of VehRegNoList"
                                    [ngValue]="item.regNo">
                                    {{item.regNo}}
                                </option>
                            </datalist>

                        </td> 

                      

                          <!-- ----------------------------- MODALFORM--------------------- -->

                   <div class="modal fade" id="customerDetails" tabindex="-1" role="dialog" aria-labelledby="customerDetailsLabel" aria-hidden="true">
                    <div class="modal-dialog modal-lg" role="document" style="max-width: fit-content;">
                        <div class="modal-content">
                         <div class="modal-header">


                          <!-- <h5 class="modal-title" id="customerDetailsLabel">Customer&nbsp;Information&nbsp;{{this.custName}}</h5> -->
                          <h6 class="modal-title" id="exampleModal20Label">Customer&nbsp;Name:&nbsp;{{this.custName}}</h6>
                          
                          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                          </button>
                         </div>
                        
                         <div class="modal-body">
                            <table class="center" style="width: 100%;">
                                <tr>

                                    <fieldset class="RFS">
                                        <legend id="FormsPH_LGAadhaar" class="RFSL" style="font-size: 10px;color: black;">CUSTOMER DETAILS</legend>
                                    <table class="center">
                                    <tr>

                                        <td style="width: 15%" class="LabelFontStyle">Cust&nbsp;Type:&nbsp;</td>

                                        <td>
                                            <input disabled    type="text"  formControlName="customerType"  id="customerType" [(ngModel)]="customerType" class="form-control" >
                                        </td>
                                        <td style="width: 15%" class="LabelFontStyle">Cust&nbsp;Account&nbsp;No:&nbsp;</td>
                                        
                                        <td>
                                            <input disabled  type="text"  formControlName="custAccountNo"  id="custAccountNo" [(ngModel)]="custAccountNo" class="form-control" >
                                        </td>

                                        <td style="width: 15%" class="LabelFontStyle1">DMS&nbsp;Cust&nbsp;No:&nbsp;</td>
                
                                        <td>
                                            <input disabled  type="text"  formControlName="dmsCustNo"  id="dmsCustNo" [(ngModel)]="dmsCustNo" class="form-control" required maxlength="10" >
                                        </td>
                                       
                                     
                                        </tr>
                                       
                                   
                                    <tr>
                
                                    
                                    <td style="width: 15%" class="LabelFontStyle">GST&nbsp;No:&nbsp;</td>
                
                                    <td>
                                        <input disabled    type="text"  formControlName="CustomerGstNo"  id="CustomerGstNo" [(ngModel)]="CustomerGstNo" class="form-control" >
                                    </td>
                                    
                                    <td style="width: 15%" class="LabelFontStyle">PAN&nbsp;:&nbsp;</td>
                
                                    <td>
                                        <input disabled    type="text"  formControlName="customerPanNo"  id="customerPanNo" [(ngModel)]="customerPanNo" class="form-control" >
                                    </td>

                                    <td style="width: 15%" class="LabelFontStyle">Tax&nbsp;Category:&nbsp;</td>
                
                                    <td>
                                        <input disabled    type="text"  formControlName="custTaxCategoryName"  id="custTaxCategoryName" [(ngModel)]="custTaxCategoryName" class="form-control" >
                                    </td>
                                    </tr>
                                    <tr>
                                    
                                        <td style="width: 15%" class="LabelFontStyle">Phone&nbsp;No:&nbsp;</td>
                        
                                        <td>
                                            <input disabled   type="text"  formControlName="custPhone"  id="custPhone" [(ngModel)]="custPhone" class="form-control" >
                                        </td>
                            
                                    </tr>
                               
                                    <tr>
                
                                        <td style="width: 5%" class="LabelFontStyle">Site&nbsp;Address:&nbsp;</td>
                    
                                        <td>
                                            <input disabled  style="width: 470%"  type="text"  formControlName="customerSiteAddress"  id="customerSiteAddress" [(ngModel)]="customerSiteAddress" class="form-control" >
                                        </td>
                                    </tr>
                                    <tr>
                        
                                        <td style="width: 5%" class="LabelFontStyle">City&nbsp;:&nbsp;</td>
                    
                                        <td>
                                            <input disabled    type="text"  formControlName="custCity"  id="custCity" [(ngModel)]="custCity" class="form-control" >
                                        </td>
                                        <td style="width: 5%" class="LabelFontStyle">State&nbsp;:&nbsp;</td>
                    
                                        <td>
                                            <input disabled    type="text"  formControlName="custState"  id="custState" [(ngModel)]="custState" class="form-control" >
                                        </td>
                                        <td style="width: 5%" class="LabelFontStyle">PIN&nbsp;:&nbsp;</td>
                    
                                        <td>
                                            <input disabled    type="text"  formControlName="custPincode"  id="custPincode" [(ngModel)]="custPincode" class="form-control" >
                                        </td>

                                    </tr>
                
                                    </table>
                                    </fieldset>

                                    <div class="modal-footer">
                                       <button type="button" class="btn btn-info" data-dismiss="modal">Close</button>
                                    </div>


                                </tr>
                            </table>
                         </div>
                        </div>
                    </div>
                   </div>
                    <!-- -----------------------------CUSTOMER MODAL FORM ENDS HERE--------------------- -->
                                                  
                           
                               
                               <td style="width: 15%" class="LabelFontStyle1">Customer&nbsp;No:&nbsp;</td>

                            
                               <td>
                                <table>
                                <tr>
                                <div *ngIf="enableCustAccount ,then thenBlockCustno; else elseBlockCustno")></div>
                                <ng-template #thenBlockCustno>
                                    <div *ngIf="displayButton ,then thenshowCustNumYes; else thenshowCustNumNo")></div>
                                    <ng-template #thenshowCustNumYes>
                                        <td><input  style=" background-color: yellow; text-align: left;" type="number" formControlName="custAccountNo"  id="custAccountNo" [(ngModel)]="custAccountNo" (change)="CustAccountNoSearch(custAccountNo)"   class="form-control" > </td>
                                   </ng-template>
                                   <ng-template #thenshowCustNumNo>
                                    <td><input disabled style="background-color: yellow;text-align: left;" type="number" formControlName="custAccountNo"  id="custAccountNo" [(ngModel)]="custAccountNo" (change)="CustAccountNoSearch(custAccountNo)"   class="form-control" > </td>
                                  </ng-template>

                                </ng-template>
                                <ng-template #elseBlockCustno>
                                    <td>
                                    <input style="width: 100px;"  disabled type="number" formControlName="custAccountNo"  id="custAccountNo" [(ngModel)]="custAccountNo" (change)="CustAccountNoSearch(custAccountNo)"   class="form-control"  placeholder="">
                                    </td>
                                </ng-template>

                               

                             
                               <!-- //////////////////////////CUSTOMER MODAL FORM/////////////////////// -->
                              
                              
                               
                               <td>

                                <!-- <td colspan="8" style="text-align: left; width: 100%;">
                                    <button  type="submit"  (click)= "SearchCustomerAll()" class="btn btn-primary"><i
                                            class="fa fa-search" data-toggle="modal" data-target="#exampleModal3"></i></button> -->

                                <!-- <button type="button" class="btn btn-primary"  (click)=SearchCustomerAll() 
                                    data-toggle="modal" data-target="#exampleModal3">...</button>
                               -->
                               
                                    <div class="modal fade" id="exampleModal3" tabindex="-1"
                                    role="dialog" aria-labelledby="exampleModal3Label"
                                    aria-hidden="true" style="height: 450px ; padding-top: 0px;" >

                                    <!-- <div style="width: 600px; margin-left:400px"> -->
                                    <div class="modal-dialog modal-dialog-scrollable" role="document">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <h5 class="modal-title"  id="exampleModal3Label">Customer Search</h5>
                                                <!-- <label
                                                    style="color: black;font-size: large;text-align: center;margin-left: 10rem;">
                                                    Customer Details
                                                </label> -->
                                                <button type="button" class="close"
                                                    data-dismiss="modal" aria-label="Close">
                                                    <span aria-hidden="true">&times;</span>
                                                </button>
                                            </div>

                                            
                                            <div class="modal-body">

                                                <table class="center" style="width: 100%;">
                                                    
                                                    <tr>
                  
                                                        <td style="width: 15%" class="LabelFontStyle">
                                                            Operating &nbsp;Unit&nbsp;:&nbsp;
                                                        </td>
                
                                                        <td>
                                                            <input  readonly type="text" class="form-control" formControlName="ouId"  [(ngModel)]="ouId">
                                                        </td>

                                                        <td  style="width: 13% " class="LabelFontStyle">Search&nbsp;By&nbsp;:</td>
                                                        <td> 
                                                            <select   formControlName="searchBy" id="searchBy" [(ngModel)]="searchBy" class="form-control">
                                                                <option value="CUSTOMER ACCOUNT NUMBER">CUSTOMER ACCOUNT NUMBER</option>
                                                                <option value="CUSTOMER NAME">CUSTOMER NAME</option>
                                                                <option value="PHONE NUMBER">PHONE NUMBER</option>
                                                            </select>
                                                        </td>
                        
                                                        <td style="width: 15%" class="LabelFontStyle">Search&nbsp;Value&nbsp;:</td>
                                                        <td>
                                                            <input   type="text" formControlName="searchValue" [(ngModel)]="searchValue"   class="form-control" placeholder="Enter Search value" >
                                                        </td>
                        
                                                        <td>
                                                            <!-- <button style="width: 10em;" type="button" (click)="searchCustomer(searchBy,searchValue)" class="btn btn-info"  id="register" >Search</button> -->
                                                            <button style="width: 10em;" type="button" (click)="findSearchByValue(searchBy,searchValue)" class="btn btn-info"  id="register" >Search</button>
                                                        </td>
                
                                                       
                                                    </tr>

                                                 </table>
                                                <table class="auto-style4" class="GridFont"
                                                    cellspacing="0" cellpadding="4" border="0"
                                                    id="ctl00_cpForm_grdActions"
                                                    style="border-color:#959595;width:100%;border-collapse:collapse;">
                                                    <tbody>
                                                        <tr class="GridHeader">
                                                            <th scope="col">CusomerId</th>
                                                            <th scope="col">CustAccountNo</th>
                                                            <th scope="col">Customer Name</th>
                                                            <th scope="col">Cust Type</th>
                                                            <th scope="col">Address1</th>
                                                            <th scope="col">Address2</th>
                                                            <th scope="col">City</th>
                                                            <th scope="col">State</th>
                                                            <th scope="col">PIN</th>
                                                            <th scope="col">Phone</th>
                                                            <th scope="col">Select one</th>
                                                    </tbody>

                                                    <tr *ngFor="let com of lstCustomer" class="ItemStyle" style="text-decoration:none;">
                                                        <td>{{com.customerId}}</td>
                                                        <td>{{com.custAccountNo}}</td>
                                                        <td>{{com.custName}}</td>
                                                        <td>{{com.custType}}</td>
                                                        <td>{{com.address1}}</td>
                                                        <td>{{com.address2}}</td>
                                                        <td>{{com.city}}</td>
                                                        <td>{{com.state}}</td>
                                                        <td>{{com.pinCd}}</td>
                                                        <td>{{com.mobile1}}</td>
                                                        <td>  <button  class="btn btn-secondary" (click)="Select(com.customerId)">Select</button></td>  
                                                       
                                                    </tr>
                                                </table>
                                            </div>

                                            <div class="modal-footer">
                                                <button type="button" class="btn btn-info" data-dismiss="modal">Close</button>
                                            </div>
                                         
                                            </div>
                                        </div>
                                    </div>
                                </td>
                                </tr>
                                </table>
                            </td>
                            <td style="width: 15%" class="LabelFontStyle">Cust&nbsp;Name:&nbsp;</td>
                            <td>
                                <input  disabled   type="text" formControlName="custName"  id="custName" [(ngModel)]="custName"   class="form-control"  placeholder="">
                            </td>
                            <td></td>
                            
                            <td>
                                <button type="button"  class="btn btn-primary" 
                                data-toggle="modal" data-target="#customerDetails"   style="width: 9rem;color: black;">
                                &nbsp;View&nbsp;Customer&nbsp;Details</button>
                            </td>

                             
                        </tr>
                        <tr>


                            <!-- <td style="width: 15%" class="LabelFontStyle">Customer&nbsp;Address:&nbsp;</td>
                            
                            <td>
                                <input  disabled   type="text" formControlName="custSiteAddress"  id="custSiteAddress" [(ngModel)]="custSiteAddress" class="form-control"  placeholder="Customer Site Address............................................................">
                            </td> -->
                            <td>
                                <input hidden  type="text" formControlName="billToSiteId"  id="billToSiteId" [(ngModel)]="billToSiteId" class="form-control" >
                            </td>
                        </tr>
                    </table>
                    </fieldset>

                                    
                     

                    <!-- <table style="width: 100%; background-color: #4d3f28;" >
                    <tr>
                        <td class="SubHeading2">&nbsp;&nbsp;</td>
                    </tr>
                    </table> -->

                   

                            <fieldset class="RFS">
                                <legend id="FormsPH_LGAadhaar" class="RFSL" style="font-size: 10px;color: black;">Receipt Details</legend>
                                
                            <table class="center">

                                
                                <tr>

                                    <td style="width: 15%" class="LabelFontStyle">Receipt&nbsp;No:&nbsp;</td>
                                    <td> <input disabled  style="font-weight: bold; background-color: lightgreen;"  type="text" formControlName="receiptNumber"  id="receiptNumber" [(ngModel)]="receiptNumber" class="form-control"> </td>
                                
                                    <td style="width: 15%" class="LabelFontStyle">Receipt&nbsp;Date&nbsp;</td>
                                    <td><input  disabled  type="date"  formControlName="receiptDate"  id="receiptDate" [(ngModel)]="receiptDate" class="form-control" style="background-color: lightgreen;" ></td>
                                    

                                    <div *ngIf="displayButton ,then thenshowDet1Yes; else thenshowDet1No")></div>
                                    <ng-template #thenshowDet1Yes>
                                     
                                        <td style="width: 15%" class="LabelFontStyle">GL&nbsp;Date&nbsp;</td>
                                        <td><input   type="date"  formControlName="glDate"  id="glDate" [(ngModel)]="glDate" class="form-control" 
                                            max="{{minDate | date:'yyyy-MM-dd'}}" (change)="glPrdValidate(glDate)" style="background-color: yellow;"></td>
                                        
                                        <td  style="width: 15%" class="LabelFontStyle1">Receipt&nbsp;Amount:&nbsp;</td>
                                        <td>  <input style="font-weight: bold;text-align: right;"   type="number"   min="1" formControlName="paymentAmt"  id="paymentAmt"  [(ngModel)]="paymentAmt" class="form-control" (change)="validateAmt(paymentAmt)" style="background-color: yellow;">    </td>
                                    </ng-template>

                                    <ng-template #thenshowDet1No>
                                 
                                        
                                        <td style="width: 15%" class="LabelFontStyle">GL&nbsp;Date&nbsp;</td>
                                        <td><input disabled  type="date"  formControlName="glDate"  id="glDate" [(ngModel)]="glDate" class="form-control" (change)="glPrdValidate(glDate)" style="background-color: yellow;"></td>
                                        
                                        <td  style="width: 15%" class="LabelFontStyle1">Receipt&nbsp;Amount:&nbsp;</td>
                                         <td><input disabled  style="font-weight: bold;text-align: right;"   type="number"   min="1" formControlName="paymentAmt"  id="paymentAmt"  [(ngModel)]="paymentAmt" class="form-control" (change)="validateAmt(paymentAmt)" style="background-color: yellow;">    </td>
                                    </ng-template>


                                </tr>

                                
                                <tr>

                             
                                    <div *ngIf="displayButton ,then thenshowDet2Yes; else thenshowDet2No")></div>
                                    <ng-template #thenshowDet2Yes>

                                        <td style="width: 15%" class="LabelFontStyle1">&nbsp;Status:&nbsp;</td>
            
                                        <td>  
                                        <select disabled formControlName="status" id="status" [(ngModel)]="status" class="form-control" style="background-color: yellow;" >
                                            <option disabled>--Select--</option>
                                            <option *ngFor="let sc of  ReceiptStatusList" [ngValue]="sc.code"  >
                                              {{sc.code}}
                                            </option>
                                        </select>
                                        </td>

                                    <td style="width: 15%" class="LabelFontStyle1">Ref.&nbsp;Type:&nbsp;</td>

                                    <td>  
                                        <select formControlName="refType" id="refType" [(ngModel)]="refType" class="form-control" style="background-color: yellow;"
                                                                (ngModelChange)='onRefTypeSelected($event)'>
                                            <option disabled>--Select--</option>
                                            <option *ngFor="let sc of  ReceiptTypeArList" [ngValue]="sc.code"  >
                                                {{sc.code}}
                                             </option>
                                        </select>
                                    </td>

                                    <td style="width: 15%" class="LabelFontStyle">Ref.&nbsp;No:&nbsp;</td>

                                    <div *ngIf="showRefYellow; then thenBlockRef1; else elseBlockRef1"></div>
                                    <ng-template #thenBlockRef1>
                                        <td> <input   type="text" formControlName="referenceNo"  id="referenceNo"  [(ngModel)]="referenceNo" class="form-control"  style="background-color: yellow;">  </td>
                                    </ng-template>
                                    <ng-template #elseBlockRef1>
                                        <td><input   type="text" formControlName="referenceNo"  id="referenceNo"  [(ngModel)]="referenceNo" class="form-control"  placeholder=" ">   </td>
                                    </ng-template>


                                    <td style="width: 15%" class="LabelFontStyle">Ref&nbsp;Date&nbsp;</td>
                                    <td><input   type="date"  formControlName="referenceDate"  id="referenceDate" 
                                        max="{{minDate | date:'yyyy-MM-dd'}}" [(ngModel)]="referenceDate" class="form-control" ></td>
                                   
                                    </ng-template>


                                    <ng-template #thenshowDet2No>

                                        <td style="width: 15%" class="LabelFontStyle1">&nbsp;Status:&nbsp;</td>
            
                                        <td>  
                                        <select disabled formControlName="receiptStatus" id="receiptStatus" [(ngModel)]="receiptStatus" class="form-control" style="background-color: yellow;" >
                                            <option disabled>--Select--</option>
                                            <option *ngFor="let sc of  ReceiptStatusList" [ngValue]="sc.code"  >
                                              {{sc.code}}
                                            </option>
                                        </select>
                                        </td>

                                        <td style="width: 15%" class="LabelFontStyle1">Ref.&nbsp;Type:&nbsp;</td>
    
                                        <td>  
                                            <select disabled formControlName="refType" id="refType" [(ngModel)]="refType" class="form-control" style="background-color: yellow;"
                                                                    (ngModelChange)='onRefTypeSelected($event)'>
                                                <option disabled>--Select--</option>
                                                <option *ngFor="let sc of  ReceiptTypeArList" [ngValue]="sc.code"  >
                                                    {{sc.code}}
                                                 </option>
                                            </select>
                                        </td>
    
                                        <td style="width: 15%" class="LabelFontStyle">Ref.&nbsp;No:&nbsp;</td>
                                          <td> <input  disabled type="text" formControlName="referenceNo"  id="referenceNo"  [(ngModel)]="referenceNo" class="form-control"  >  </td>
                                       
                                        <td style="width: 15%" class="LabelFontStyle">Ref&nbsp;Date&nbsp;</td>
                                        <td><input disabled  type="date"  formControlName="referenceDate"  id="referenceDate" [(ngModel)]="referenceDate" class="form-control" ></td>
                                       
                                    </ng-template>
                                    </tr>

                                    
                                    
                                    <tr>
                                    <div *ngIf="displayButton ,then thenshowDet21Yes; else thenshowDet21No")></div>
                                    <ng-template #thenshowDet21Yes>
                                    <td style="width: 15%" class="LabelFontStyle1">Pay&nbsp;Mode:&nbsp;</td>
    
                                    <td>  
                                        <select   formControlName="payType" id="payType" [(ngModel)]="payType" class="form-control" (ngModelChange)='onPayTypeSelected($event,"Active")' style="background-color: yellow;" >
                                            <option disabled>--Select--</option>
                                            <option *ngFor="let sc of  PaymentModeList" [ngValue]="sc.lookupValue"  >
                                                {{sc.lookupValue}} 
                                            </option>
                                        </select>
                                    </td>

                                    <td style="width: 15%" class="LabelFontStyle1">Pay&nbsp;Method:&nbsp;</td>
                                        <td>  
                                            <select  formControlName="receiptMethodId" id="receiptMethodId" [(ngModel)]="receiptMethodId" class="form-control"  style="background-color: yellow;">
                                                <option disabled>--Select--</option>
                                                <option *ngFor="let sc of  ReceiptMethodList " [ngValue]="sc.receiptMethodId">
                                                    {{sc.receiptMethodId}}-{{sc.methodName}} 
                                                </option>
                                            </select>
    
                                        </td>

                                    </ng-template>


                                    <ng-template #thenshowDet21No>

                                        <td style="width: 15%" class="LabelFontStyle1">Pay&nbsp;Mode:&nbsp;</td>
    
                                        <td>  
                                            <select   formControlName="payType" id="payType" [(ngModel)]="payType" class="form-control" (ngModelChange)='onPayTypeSelected($event,"Active")' style="background-color: yellow;" >
                                                <option disabled>--Select--</option>
                                                <option *ngFor="let sc of  PaymentModeList" [ngValue]="sc.lookupValue"  >
                                                    {{sc.lookupValue}} 
                                                </option>
                                            </select>
                                        </td>
    
                                        <td style="width: 15%" class="LabelFontStyle1">Pay&nbsp;Method:&nbsp;</td>
                                            <td>  
                                                <select disabled formControlName="receiptMethodId" id="receiptMethodId" [(ngModel)]="receiptMethodId" class="form-control"  style="background-color: yellow;">
                                                    <option disabled>--Select--</option>
                                                    <option *ngFor="let sc of  ReceiptMethodList " [ngValue]="sc.receiptMethodId">
                                                        {{sc.receiptMethodId}}-{{sc.methodName}} 
                                                    </option>
                                                </select>
        
                                            </td>
    
                                        </ng-template>
                                </tr>

                                <tr>


                                    <div *ngIf="showBankDetails; then thenBlock3; else elseBlock3"></div>
                                    <ng-template #thenBlock3>
                                    <td style="width: 15%" class="LabelFontStyle1">Bank&nbsp;Name:&nbsp;</td>
                                     <td>
                                        <input    type="text" formControlName="bankName"  id="bankName" [(ngModel)] ="bankName" class="form-control"  style="background-color: yellow;">
                                    </td>
                                    <td style="width: 15%" class="LabelFontStyle1">Branch&nbsp;:&nbsp;</td>
                                    <td>
                                        <input    type="text" formControlName="bankBranch"  id="bankBranch" [(ngModel)] ="bankBranch" class="form-control" style="background-color: yellow;">
                                    </td>
                                    <td style="width: 15%" class="LabelFontStyle1">&nbsp;DD/Chq.&nbsp;No:&nbsp;</td>
                                    <td>
                                        <input     type="text" formControlName="checkNo"  id="checkNo"  [(ngModel)] ="checkNo"  class="form-control" style="background-color: yellow;">
                                    </td>
                                    <td style="width: 15%" class="LabelFontStyle">DD/Chq.&nbsp;Date:&nbsp;</td>
                                    <td>
                                        <input    type="date" formControlName="checkDate"  id="checkDate"  [(ngModel)] ="checkDate" class="form-control"  style="background-color: yellow;"
                                        placeholder="" max="{{minDate | date:'yyyy-MM-dd'}}"  (change)="validateChqDate(checkDate)">
                                        <!-- min="{{minDateWedding | date:'yyyy-MM-dd'}}"> -->
                                    </td>
                             
                                    </ng-template>
                                    <ng-template #elseBlock3>

                                    <td style="width: 15%" class="LabelFontStyle1">Bank&nbsp;Name:&nbsp;</td>
                                     <td>
                                        <input  disabled  type="text" formControlName="bankName"  id="bankName" [(ngModel)] ="bankName" class="form-control"  placeholder="">
                                    </td>
                                    <td style="width: 15%" class="LabelFontStyle1">Branch&nbsp;:&nbsp;</td>
                                    <td>
                                        <input  disabled  type="text" formControlName="bankBranch"  id="bankBranch" [(ngModel)] ="bankBranch" class="form-control" placeholder="">
                                    </td>
                                    <td style="width: 15%" class="LabelFontStyle1">&nbsp;DD/Chq.&nbsp;No:&nbsp;</td>
                                    <td>
                                        <input  disabled   type="text" formControlName="checkNo"  id="checkNo"  [(ngModel)] ="checkNo"  class="form-control"  placeholder="">
                                    </td>
                                    <td style="width: 15%" class="LabelFontStyle">DD/Chq.&nbsp;Date:&nbsp;</td>
                                    <td>
                                        <input disabled   type="date" formControlName="checkDate"  id="checkDate"  [(ngModel)] ="checkDate" class="form-control"  placeholder="">
                                    </td>

                                    </ng-template>

                                </tr>

                              
                                  

                                    <tr>

                                     <td style="width: 15%" class="LabelFontStyle">Remarks&nbsp;:&nbsp;</td>
        
                                        <td>
                                            <input style="width: 450%;"   type="text" formControlName="comments"  id="comments" [(ngModel)] ="comments" class="form-control" placeholder="Enter remarks here">
                                        </td>
                                    </tr>

                            </table>
                            </fieldset>


                            <div *ngIf="displayButton; then showTotalYes; else showTotalNo"></div>
                            <ng-template #showTotalNo>

                            <fieldset class="RFS">
                                <legend id="FormsPH_LGAadhaar" class="RFSL" style="font-size: 10px;color: black;">Balances</legend>
                                
                            <table class="center">



                                <tr>
                                    <td style="width: 15%" class="LabelFontStyle">&nbsp;Applied&nbsp;&nbsp;:&nbsp;</td>
                                    <td>
                                        <input  disabled  style="text-align: right;" type="number" formControlName="totAppliedtAmount"  id="totAppliedtAmount" [(ngModel)] ="totAppliedtAmount" class="form-control" placeholder="">
                                    </td>
                                    <td style="width: 15%" class="LabelFontStyle">&nbsp;Unapplied&nbsp;&nbsp;:&nbsp;</td>
                                    <td>
                                        <input  disabled  style="text-align: right;" type="number" formControlName="totUnAppliedtAmount"  id="totUnAppliedtAmount" [(ngModel)] ="totUnAppliedtAmount" class="form-control" placeholder="">
                                    </td>
                                   
                                    <td style="width: 15%" class="LabelFontStyle">&nbsp;OnAct&nbsp;&nbsp;:&nbsp;</td>
                                    <td>
                                        <input  disabled style="text-align: right;"  type="text" formControlName="totalOnAccountAmt"  id="totalOnAccountAmt" [(ngModel)] ="totalOnAccountAmt" class="form-control" placeholder="">
                                    </td>

                                    <td style="width: 15%" class="LabelFontStyle">Balance&nbsp;&nbsp;:&nbsp;</td>
                                    <td>
                                        <input  disabled  style="text-align: right;" type="number" formControlName="balanceAmount"  id="balanceAmount" [(ngModel)] ="balanceAmount" class="form-control" placeholder="">
                                    </td>
                                </tr>
                           

                            </table>

                            </fieldset>
                       

                        <!-- <div *ngIf="showReason; then thenBlock2; else elseBlock2"></div>
                        <ng-template #thenBlock2> -->

                        <fieldset class="RFS">
                        <legend id="FormsPH_LGAadhaar" class="RFSL" style="font-size: 10px;color: black;">Reversal Details</legend>
                            
                        <table class="center">

                            <tr>
                                <td style="width: 15%" class="LabelFontStyle">&nbsp;Reason:&nbsp;</td>

                                <td>
                                    <select formControlName="reversalReasonCode" id="reversalReasonCode" [(ngModel)]="reversalReasonCode" class="form-control"
                                                             (ngModelChange)='onReasonSelected($event)'>
                                        <option disabled>--Select--</option>
                                        <option *ngFor="let sc of  ReverseReasonList" [ngValue]="sc.code"  >
                                           {{sc.code}}-{{sc.codeDesc}}
                                        </option>
                                    </select>
                                </td>
                           
                                
                            <td style="width: 15%" class="LabelFontStyle">Reversal&nbsp;Date:&nbsp;</td>
                                
                            <td>
                                <input  disabled  type="date"  formControlName="reversalDate"  id="reversalDate"  [(ngModel)]="reversalDate" class="form-control" >
                            </td>

                          
                               
                                <td style="width: 15%" class="LabelFontStyle">&nbsp;Category:&nbsp;</td>
                                <td>
                                    <input   type="text"  formControlName="reversalCategory"  id="reversalCategory"  [(ngModel)]="reversalCategory" class="form-control" >
                                </td>

                                <!-- <td>
                                    <select  formControlName="reversalCategory" id="reversalCategory" [(ngModel)]="reversalCategory" class="form-control">
                                        <option disabled>--Select--</option>
                                        <option *ngFor="let sc of  ReverseReasonList" [ngValue]="sc.cmnTypeId"  >
                                            {{sc.cmnTypeId}}-{{sc.code}}
                                        </option>
                                    </select>
                                </td> -->

                                <td style="width: 15%" class="LabelFontStyle">Comments&nbsp;:&nbsp;</td>
                                
                                <td>
                                    <input  style="text-transform:uppercase;"  type="text"  formControlName="reversalComment"  id="reversalComment"  [(ngModel)]="reversalComment" class="form-control" >
                                </td>

                              </tr>
                             
                        </table>
                        </fieldset>
                        </ng-template>
                        <ng-template #showTotalYes>

                        </ng-template>

                        <!-- </ng-template>
                        <ng-template #elseBlock2> </ng-template> -->
                  




                            <!-- <table style="width: 100%; background-color: #4d3f28;" >
                            <tr>
                                <td class="SubHeading2">&nbsp;&nbsp;</td>
                            </tr>
                            </table> -->

                             <!-- ----------------------------------------buttons-------------------- -->
                    <br>
                     <table class="center">
                        <tr>
                            <div *ngIf="displayButton; then thenBlock1; else elseBlock1"></div>
                            <ng-template #thenBlock1>
                                <td>
                                    <button type="button" class="btn btn-info" (click)="newMast()" [disabled]="!paymentArForm">Save</button>
                                </td>
                                

                                <!-- <td>
                                    <button type="button" class="btn btn-info" (click)="applyRcpt(searchValue)">Apply</button>
                                </td> -->

                                                                <!-- ====================Reset Dialog ======================== -->

                                <td>
                                    <button type="button" class="btn btn-info" data-toggle="modal" data-target="#exampleModal">Reset</button>
                                </td>
                                <!-- Modal -->
                                <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true" style="max-width: 500px; ">
                                    <div class="modal-dialog" role="document" >
                                    <div class="modal-content">
                                        <div class="modal-body">
                                            <label style="font-size: small; color: black;font-weight: bold; text-align:center;vertical-align: middle;">
                                                <!-- &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -->
                                                Want&nbsp;to&nbsp;Reset. &nbsp;Confirm&nbsp;(Yes/No)?&nbsp;
                                            </label>
                                        </div>
                                        <div class="modal-footer">
                                            <table class="center">
                                                <tr>
                                                    <td>
                                                        <button type="button" class="btn btn-info" data-dismiss="modal">No</button>
                                                    </td>
                                                    <td>
                                                        <button type="submit" class="btn btn-info" id="register" (click)="resetMast()">Yes</button> 
                                                    </td>
                                                </tr>
                                            </table>
                                        </div>
                                    </div>
                                    </div>
                                </div>

                                        <!-- =====================Close Dialog Box====================== -->
                                        <td>
                                        <button type="button" class="btn btn-info" data-toggle="modal" data-target="#exampleModalLong">Close</button>
                                        </td>
                                        <!-- Modal -->
                                        <div class="modal fade" id="exampleModalLong" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle" aria-hidden="true" style="max-width: 500px;">
                                            <div class="modal-dialog" role="document">
                                            <div class="modal-content">
                                                <div class="modal-body">
                                                    <label style="font-size: small; color: black; font-weight: bold; text-align: center; vertical-align: middle;">
                                                        <!-- &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -->
                                                        Want&nbsp;to&nbsp;Close.&nbsp;Confirm&nbsp;(Yes/No)?&nbsp;
                                                    </label>
                                                </div>
                                                <div class="modal-footer">
                                                    <table class="center">
                                                        <tr>
                                                            <td>
                                                            <button  type="submit" class="btn btn-info" data-dismiss="modal" id="register"   (click)="closeMast()">Yes</button>
                                                            </td>
                                                            <td>
                                                            <button type="button" class="btn btn-info" data-dismiss="modal">No</button>
                                                            </td>
                                                        </tr>
                                                    </table>
                                                </div>
                                            </div>
                                            </div>
                                        </div>

                                        <!-- ==================================================== -->

                            </ng-template>
                            <ng-template #elseBlock1>
                        
                                    <div *ngIf="enableCancelButton; then CancelButtonYes; else CancelButtonNo"></div>
                                    <ng-template #CancelButtonYes>
                                    <td>
                                        <button  type="button" class="btn btn-info" (click)="reverseReceipt()">Cancel</button>
                                    </td>
                                    </ng-template>
                                    <ng-template #CancelButtonNo>
                                        <td>
                                            <button disabled type="button" class="btn btn-info" (click)="reverseReceipt()">Cancel</button>
                                        </td>
                                    </ng-template>


                                                             <!-- ==========================SEARCH & APPLY =============================== -->

                            <div *ngIf="enableApplyButton; then ApplyButtonYes; else ApplyButtonNo"></div>
                            <ng-template #ApplyButtonYes>
                            
                            <td>
                                <button type="button"  class="btn btn-primary" 
                                data-toggle="modal" data-target="#exampleModal2"  (click)="LoadValues()" style="width: 5rem;color: black;">
                                &nbsp;Apply</button>
                            </td>
                            </ng-template>
                            <ng-template #ApplyButtonNo>
                                <td>
                                    <button disabled type="button"  class="btn btn-primary" 
                                    data-toggle="modal" data-target="#exampleModal2"  (click)="LoadValues()" style="width: 5rem;color: black;">
                                    &nbsp;Apply</button>
                                </td>
                            </ng-template>




                        <div *ngIf="showModalForm; then ShowMYes; else ShowMNo"></div>
                        <ng-template #ShowMYes>
                        <!-- =================modal================= -->
                        <div class="modal fade" id="exampleModal2" tabindex="-1" role="dialog" aria-labelledby="exampleModal2Label" aria-hidden="true">
                            <div class="modal-dialog modal-lg" role="document">
                                <div class="modal-content">
                                 <div class="modal-header">
                                  <h5 class="modal-title" id="exampleModal2Label">AR&nbsp;Receipt&nbsp;Application&nbsp;-&nbsp;Receipt&nbsp;No:&nbsp;{{this.receiptNumber}}&nbsp;BillToSite:&nbsp;{{this.billToSiteId}} </h5>
                                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                  </button>
                                 </div>
                                
                                 <div class="modal-body">
                                 <table class="center" style="width: 100%;">
                                    <tr>

                                        <td style="width: 15%" class="LabelFontStyle">
                                            Customer &nbsp;No&nbsp;:&nbsp;
                                        </td>

                                        <td>
                                            <input  readonly type="text" class="form-control" formControlName="custAccountNo"  [(ngModel)]="custAccountNo">
                                        </td>

                                        <td style="width: 15%" class="LabelFontStyle">
                                            Customer &nbsp;Name&nbsp;:&nbsp;
                                        </td>

                                        <td>
                                            <input  readonly type="text" class="form-control" formControlName="custName"  [(ngModel)]="custName">
                                        </td> 

                                        <td style="width: 15%" class="LabelFontStyle">
                                            Receipt &nbsp;Amt&nbsp;:&nbsp;
                                        </td>

                                        <td>
                                            <input readonly type="number" class="form-control" formControlName="receiptAmount"  [(ngModel)]="receiptAmount">
                                        </td>
                                        
                                    </tr>
                                    <tr>

                                        <td style="width: 15%" class="LabelFontStyle">
                                            Applied &nbsp;Amt&nbsp;:&nbsp;
                                        </td>

                                        <td>
                                            <input readonly  type="number" class="form-control" formControlName="tApplAmt"  [(ngModel)]="tApplAmt">
                                        </td>

                                        <td style="width: 15%" class="LabelFontStyle">
                                            On Account&nbsp;Amt&nbsp;:&nbsp;
                                        </td>

                                        <td>
                                            <input readonly  type="number" class="form-control" formControlName="onAccountAmt"  [(ngModel)]="onAccountAmt">
                                        </td> 

                                        <td style="width: 15%" class="LabelFontStyle">
                                            Un Applied &nbsp;Amt&nbsp;:&nbsp;
                                        </td>

                                        <td>
                                            <input readonly type="number" class="form-control" formControlName="tUapplAmt"  [(ngModel)]="tUapplAmt">
                                        </td>
                                         <td>
                                            <input readonly hidden type="number" class="form-control" formControlName="balanceAmount"  [(ngModel)]="balanceAmount">
                                        </td>
                                        
                                    </tr>
                                 </table>

                                 <table style="width: 100%; background-color: #FFE4B5;">
                                    <tr>
                                        <td style="width: 13.5%" class="LabelFontStyle">Apply&nbsp;To:&nbsp;</td>
                                        <td> 
                                            <table>
                                            <tr>
                                            <td>
                                            <select  formControlName="applyTo"  id ="applyTo"  [(ngModel)]="applyTo"  class="form-control" (ngModelChange)='OnApplyTypeSelected($event)'  >
                                                <!-- <option>--Select--</option> -->
                                                <option value="INVOICE">INVOICE</option>
                                                <option value="ON ACCOUNT">ON ACCOUNT</option>
                                                <option value="REFUND">REFUND</option>
                                            </select>
                                            </td>
                                              
                                            <td>
                                                <button style="width: 8em;" type="button" class="btn btn-info" (click)="SearchInvoices(custAccountNo,billToSiteId,applyTo,receiptNumber)"  >Run</button>
                                            </td>
                                            </tr>    
                                            </table>
                                       
                                        </td>
                                    
                                        <td>
                                            <button style="width: 8em;" type="button" class="btn btn-info" (click)="AppliedDetails(custAccountNo,billToSiteId,applyTo,receiptNumber)"  >Apply&nbsp;Details</button>
                                        </td>

                                         <!-- <td style="width: 15%" class="LabelFontStyle">
                                            Customer &nbsp;Id/Site&nbsp;:&nbsp;
                                        </td> -->

                                        <td>
                                            <input  hidden type="text" class="form-control" formControlName="customerId"  [(ngModel)]="customerId">
                                        </td>

                                        <td>
                                            <input  hidden type="text" class="form-control" formControlName="customerSiteId"  [(ngModel)]="customerSiteId">
                                        </td>
                                        <td>
                                            <input  hidden type="text" class="form-control" formControlName="custAddr"  [(ngModel)]="custAddr">
                                        </td>

                                    </tr>
                                  </table>


                                  <div *ngIf="showInvoiceGrid ,then showInvYes; else showInvNo")></div>
                                  <ng-template #showInvYes>


                                  <div class="container1">
                                        <div class="grid_scroll_3">
                                        <table class="auto-style4" class="GridFont" cellspacing="0" cellpadding="4" border="0" id="ctl00_cpForm_grdActions" style="border-color:#959595;border-collapse:collapse;width: 100%;">
                                       <tbody>
                                            <tr class="GridHeader">
                                              
                                                <th style="width:6rem" scope="col">Srl#</th>
                                                <th style="width:3rem;text-align: center;" scope="col"><input  type="checkbox" formControlName="selectAllflag1" [(ngModel)]="selectAllflag1" (change)="applyReceiptFlagAll($event)"></th>
                                                <!-- <th style="width:3rem;text-align: center;" scope="col"><button style="width: 8em;" type="button" class="btn btn-info" (click)="applyReceiptFlagAll101()">Select All</button></th> -->
                                                <!-- <button style="width: 8em;" type="button" class="btn btn-info" (click)="AppliedDetails(custAccountNo,billToSiteId,applyTo,receiptNumber)"  >Apply&nbsp;Details</button> -->
                                            
                                                <th style="width:6rem" scope="col">Application Type</th>
                                                <th style="width:6rem" scope="col">Invoice No</th>
                                                <th style="width:6rem" scope="col">Invoice Date</th>
                                                <th style="width:10rem" scope="col">Invoice Amt</th>
                                                <th style="width:10rem" scope="col">Applied Amt</th>
                                                <th style="width:11rem" scope="col">Apply Date</th>
                                                <th style="width:11rem" scope="col">GL Date</th>
                                                <th style="width:10rem" scope="col">Apply Amt</th>
                                                <th style="width:10rem" scope="col">Balance  Due</th>
                                                <th style="width:10rem" scope="col">Balance</th>
                                                <!-- <th style="width:10rem" scope="col">billToCustId</th> -->
                                                <!-- <th style="width:10rem" scope="col">billToSiteId</th>  -->


                                           </tr>
                                       </tbody>
                                       <ng-container  class="center" formArrayName="invLine">
                                        <ng-container   *ngFor="let group of invLineArray().controls; let k= index" [formGroupName]="k" class="auto-style5">  
                                                <!-- <tr *ngFor="let com of lstinvoices let i=index" class="ItemStyle" style="text-decoration:none;"> -->
                                                   <tr>
                                                    <td style="text-align: right;">{{k+1}}</td>
                                                    <td><input  type="checkbox"  style="text-align: center;width: 3rem;"  formControlName="applyrcptFlag" (change)="applyReceiptFlag($event,k)"></td>
                                                    <td><input style="width: 100px;height: 25px;text-align: center;"      disabled  type="text" formControlName="applyTo" [(ngModel)]="applyTo" class="form-control" placeholder="Appl Type"  > </td>
                                                    <td><input style="width: 140px;height: 25px;" type="text"             disabled formControlName="trxNumber" class="form-control"></td>
                                                    <td><input style="width: 130px;height: 25px;text-align: center;"       disabled type="text" formControlName="trxDate" class="form-control"></td>   
                                                    <!-- <td>{{trxDate | date:'dd-MM-y'}}</td>  -->
                                                    <td><input style="width: 95px;height: 25px;text-align: right;" disabled  type="text" formControlName="invoiceAmount" class="form-control"></td>
                                                    <td><input style="width: 95px;height: 25px;text-align:right;"  disabled  type="text" formControlName="applAmt"  class="form-control"  > </td>
                                                    <td><input style="width: 145px;height: 25px;text-align: center;" disabled  type="date" formControlName="applDate" [(ngModel)]="applDate" class="form-control"></td>
                                                    <td><input disabled style="width: 150px;height: 25px;text-align: right;background-color:yellow;"    type="date" formControlName="glDateLine"  class="form-control" (change)="glPrdValidateLine(k)"></td>
                                                    <td><input disabled style="width: 120px;height: 25px;text-align: right;background-color: yellow;"   type="number" min="0" formControlName="applAmtNew" (change)="validateLineApplAmt(k)" class="form-control" placeholder="" > </td>
                                                    <td><input style="width: 98px;height: 25px;text-align: right;" disabled    type="text" formControlName="balDueAmt" class="form-control" placeholder="" > </td>
                                                    <td><input style="width: 100px;height: 25px;text-align: right;"     disabled  type="text" formControlName="balance1" class="form-control" placeholder="balance" ></td>
                                                    <td><input style="width: 100px;height: 25px;text-align: right;"   hidden disabled  type="text" formControlName="billToCustId" class="form-control" placeholder="custid" ></td>
                                                    <td><input style="width: 100px;height: 25px;text-align: right;"   hidden disabled   type="text" formControlName="billToSiteId" class="form-control" placeholder="siteid" ></td>
                                                    <!-- <td>  <button  class="btn btn-secondary" (click)="ApplyRcpt(com.trxNumber,receiptNumber)">Apply</button></td>   -->
                                                </tr>
                                                </ng-container>
                                                </ng-container>
                                        </table>
                                            </div>
                                    </div>
                                </ng-template>
                                <ng-template #showInvNo> </ng-template>

                                <div *ngIf="showRefundGrid ,then showRefYes; else showRefNo")></div>
                                             <ng-template #showRefYes>
 
                                                <div class="container1">
                                                    <div class="grid_scroll_3">
                                                    <table class="auto-style4" class="GridFont" cellspacing="0" cellpadding="4" border="0" id="ctl00_cpForm_grdActions" style="border-color:#959595;border-collapse:collapse;width: 100%;">
                                                   <tbody>
                                                        <tr class="GridHeader">
                                                          
                                                            <th style="width:3rem" scope="col">Srl#</th>
                                                             <th style="width:3rem;text-align: center;" scope="col"><input  type="checkbox" formControlName="selectAllflag1" [(ngModel)]="selectAllflag1" (change)="applyReceiptFlagAll($event)"></th>
                                                            <th style="width:6rem" scope="col">Application Type</th>
                                                            <th style="width:11rem" scope="col">Refund Date</th>
                                                            <th style="width:11rem" scope="col">GL Date</th>
                                                            <th style="width:10rem" scope="col">Refund Amt</th>
                                                            <th style="width:10rem" scope="col">Refund Reason</th>
                                                          </tr>
                                                   </tbody>
                                                   <ng-container  class="center" formArrayName="invLine">
                                                    <ng-container   *ngFor="let group of invLineArray().controls; let k= index" [formGroupName]="k" class="auto-style5">  
                                                            <!-- <tr *ngFor="let com of lstinvoices let i=index" class="ItemStyle" style="text-decoration:none;"> -->
                                                               <tr>
                                                                <td style="text-align: right;">{{k+1}}</td>
                                                                <td><input  type="checkbox"  style="text-align: center;width: 3rem;"  formControlName="applyrcptFlag" (change)="applyReceiptFlagRefund($event,k)"></td>
                                                                <td><input style="width: 150px;height: 25px;text-align: center;"  disabled  type="text" formControlName="applyTo" [(ngModel)]="applyTo" class="form-control" placeholder="Appl Type"  > </td>
                                                                <td><input style="width: 150px;height: 25px;text-align: right;" disabled  type="date" formControlName="applDate" [(ngModel)]="applDate" class="form-control"></td>
                                                                <td><input style="width: 150px;height: 25px;text-align: right; background-color:yellow;"   type="date" formControlName="glDateLine"  class="form-control"  (change)="glPrdValidateLine(k)"></td>
                                                                <td><input style="width: 150px;height: 25px;text-align: right;background-color: yellow;"    type="number" min="0" formControlName="applAmtNew" (change)="validateLineRefAmt(k)" class="form-control" > </td>
                                                                <!-- <td><input style="width: 480px;height: 25px;text-align: left;background-color: yellow;"    type="text" formControlName="refReasonCode" class="form-control" > </td> -->
                                                                <td>
                                                                    <select formControlName="refReasonCode" id="refReasonCode" [(ngModel)]="refReasonCode" class="form-control"  style="width: 480px;height: 25px;text-align: left;background-color: yellow;">
                                                                                             <!-- (ngModelChange)='onReasonSelected($event)'> -->
                                                                        <option disabled>--Select--</option>
                                                                        <option *ngFor="let sc of  RefReasonList" [ngValue]="sc.cmnTypeId"  >
                                                                            {{sc.cmnTypeId}}-{{sc.code}}-{{sc.cmnDesc}}
                                                                        </option>
                                                                    </select>
                                                                </td>
                                                                </tr>
                                                            </ng-container>
                                                            </ng-container>
                                                    </table>
                                                        </div>
                                                </div>
                                              </ng-template>

                                             <ng-template #showRefNo> </ng-template>



                                </div>
                                <div class="modal-footer">
                                  <!-- <button type="button" class="btn btn-info"  >Save</button> -->
                                  <div *ngIf="validateStatus ,then vStatusYes; else vStatusNo")></div>
                                     <ng-template #vStatusYes>
                                         <button style="width: 8em;" type="button" class="btn btn-info" (click)="validateSave(applyTo)">Validate</button>
                                     </ng-template>
                                     <ng-template #vStatusNo>
                                        <button disabled style="width: 8em;" type="button" class="btn btn-info" (click)="validateSave(applyTo)">Validate</button>
                                    </ng-template>
                                    
                                    <div *ngIf="applySaveButton ,then appSaveYes; else appSaveNo")></div>
                                    <ng-template #appSaveYes>
                                        <button style="width: 8em;" type="button" class="btn btn-info" (click)="SaveApply(applyTo)">Save</button>
                                    </ng-template>
                                    <ng-template #appSaveNo>
                                        <button disabled style="width: 8em;" type="button" class="btn btn-info" (click)="SaveApply(applyTo)">Save</button>
                                    </ng-template>
                                  
                                  <button type="button" class="btn btn-info" data-dismiss="modal">Close</button>
                                  <!-- <button type="button" class="btn btn-info" (click)="resetModalMast()">Reset</button> -->
                            
                                </div>
                              </div>
                            </div>
                          </div>
                        </ng-template>
                        <ng-template #ShowMNo> </ng-template>

                    
                <!-- ====================Reset Dialog ======================== -->

                <td>
                    <button type="button" class="btn btn-info" data-toggle="modal" data-target="#exampleModal">Reset</button>
                </td>
                <!-- Modal -->
                            <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                                <div class="modal-dialog" role="document" style="max-width: 500px;">
                                <div class="modal-content">
                                    <div class="modal-body">
                                        <label style="font-size: small; color: black;font-weight: bold; text-align:center;vertical-align: middle;">
                                            <!-- &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -->
                                            Want&nbsp;to&nbsp;Reset. &nbsp;Confirm&nbsp;(Yes/No)?&nbsp;
                                        </label>
                                    </div>
                                    <div class="modal-footer">
                                        <table class="center">
                                            <tr>
                                                <td>
                                                    <button type="button" class="btn btn-info" data-dismiss="modal">No</button>
                                                </td>
                                                <td>
                                                    <button type="submit" class="btn btn-info" id="register" (click)="resetMast()">Yes</button> 
                                                </td>
                                            </tr>
                                        </table>
                                    </div>
                                </div>
                                </div>
                            </div>

                                    <!-- =====================Close Dialog Box====================== -->
                                    <td>
                                    <button type="button" class="btn btn-info" data-toggle="modal" data-target="#exampleModalLong">Close</button>
                                    </td>
                                    <!-- Modal -->
                                    <div class="modal fade" id="exampleModalLong" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle" aria-hidden="true">
                                        <div class="modal-dialog" role="document" style="max-width: 500px;">
                                        <div class="modal-content">
                                            <div class="modal-body">
                                                <label style="font-size: small; color: black; font-weight: bold; text-align: center; vertical-align: middle;">
                                                    <!-- &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -->
                                                    Want&nbsp;to&nbsp;Close.&nbsp;Confirm&nbsp;(Yes/No)?&nbsp;
                                                </label>
                                            </div>
                                            <div class="modal-footer">
                                                <table class="center">
                                                    <tr>
                                                        <td>
                                                        <button  type="submit" class="btn btn-info" data-dismiss="modal" id="register"   (click)="closeMast()">Yes</button>
                                                        </td>
                                                        <td>
                                                        <button type="button" class="btn btn-info" data-dismiss="modal">No</button>
                                                        </td>
                                                    </tr>
                                                </table>
                                            </div>
                                        </div>
                                        </div>
                                    </div>

                                    <!-- ==================================================== -->


                    </ng-template>

                   <!-- ////////////////VALIDATIONS -->
                   <!-- <td>
                    <button type="button" class="btn btn-info" (click)="CheckDataValidations1()" >Validate</button>
                   </td>
                     -->

                </tr>
                </table>
                <!-- <br> -->

                <!-- <table style="width: 100%; background-color: #FFE4B5;" >
                    <tr>
                        <td style="text-align: center;" class="SubHeading2">Search&nbsp;Receipt&nbsp;</td>
                    </tr>
                </table> -->

            

                <fieldset class="RFS">
                    <legend id="FormsPH_LGAadhaar" class="RFSL" style="font-size: 12px;color: black;font-weight: bold;">
                       SEARCH</legend>
                <table class="center" style="width: 100%;background-color: #FFE4B5;">
                    <tr>
                      <td >
                          <table class="center">
                              <tr>

                                
                                <!-- <td  style="background-color: #FFE4B5;"> &nbsp;Receipt&nbsp;No&nbsp;:&nbsp; </td> -->
                                <td style="width: 15%" class="LabelFontStyle">&nbsp;Receipt&nbsp;No&nbsp;:&nbsp; </td>
                                <td style="background-color: #FFE4B5;">
                                    <input class="form-control" formControlName="searchByRcptNo" [(ngModel)]='searchByRcptNo'
                                        value={{searchByRcptNo}}>
                                </td>

                                
                                <td style="width: 15%" class="LabelFontStyle">&nbsp;Customer&nbsp;No:&nbsp;</td>
                    
                                <td>
                                    <input   type="text"  formControlName="searchByCustNo"  id="searchByCustNo" [(ngModel)]="searchByCustNo" class="form-control"  >
                                    <!-- (change)='OnEnterCustNo(searchByCustNo)' -->
                                </td>

                                <td style="width: 15%" class="LabelFontStyle">&nbsp;Receipt&nbsp;Date:&nbsp;</td>
                    
                                <td>
                                    <input   type="date"  formControlName="searchByDate"  id="searchByDate" [(ngModel)]="searchByDate" class="form-control"  max="{{minDate | date:'yyyy-MM-dd'}}" >
                                </td>

                                <td style="background-color: #FFE4B5;">
                                    <button type="button" class="btn-primary" (click)="SearchByRcptNo(searchByRcptNo,searchByCustNo,searchByDate)"><i class="fa fa-search"
                                            aria-hidden="true"></i></button>
                                </td>

                               
                                <td>
                                    <button style="width: 5em;" type="button" class="btn btn-info" (click)="clearSearch()">Clear</button>
                                </td>


                              </tr>
                          </table>
                      </td>
                    </tr>
                </table>
                </fieldset>
             
                    
                </form>
            </div>
        </div>
    </div>
</div>

<div class="container1">
    <div class="grid_scroll">
    <table class="auto-style4" class="GridFont" cellspacing="0" cellpadding="4" border="0" id="ctl00_cpForm_grdActions" style="border-color:#959595;border-collapse:collapse;width: 100%;">
   <tbody>
        <tr class="GridHeader">
            <th style="width:6rem" scope="col">Srl No</th>
            <th style="width:6rem" scope="col">Operating Unit</th>
            <th style="width:15rem" scope="col">Cust No/Site/Name</th>
            <th style="width:8rem" scope="col">Receipt No</th>
            <th style="width:6rem" scope="col">Receipt Date</th>
            <th style="width:10rem" scope="col">Payment Type</th>
             <th style="width:10rem" scope="col">Receipt Amt</th>
            <th style="width:10rem" scope="col">Reference Type</th>
            <th style="width:10rem" scope="col">Status</th>
            <th style="width:6rem"  scope="col">Select</th>
    </tr>
   </tbody>
            <tr *ngFor="let com of lstcomments let i=index" class="ItemStyle" style="text-decoration:none;">
                <td style="text-align: center;">{{i+1}}</td>
                <td style="text-align: center;">{{com.orgId}}</td>
                <td>{{com.custAccountNo}}/{{com.custSiteId}}/{{com.custName}}-</td>
                <td style="text-align: center;">{{com.receiptNumber}}</td>
                <td style="text-align: center;">{{com.receiptDate  |date:'dd-MM-y'}}</td>
                <td style="text-align: center;">{{com.payType}}</td>  
                <td style="text-align: right;">{{com.paymentAmt}}</td>
                <td style="text-align: center;">{{com.refType}}</td>
                <td style="text-align: center;">{{com.status}}</td>
                <td><button class="btn btn-secondary" (click)="Select(com.receiptNumber)">Select</button></td>   
               
            </tr>
    </table>
</div>
</div>